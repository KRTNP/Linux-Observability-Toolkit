{
  "dashboard": {
    "title": "Linux Observability Toolkit",
    "description": "Bundle collection metrics and service health",
    "tags": ["toolkit", "incident"],
    "timezone": "browser",
    "refresh": "30s",
    "panels": [
      {
        "title": "Bundle Collections (24h)",
        "type": "stat",
        "gridPos": { "x": 0, "y": 0, "w": 6, "h": 4 },
        "targets": [
          {
            "expr": "sum(increase(toolkit_collection_total[24h]))",
            "legendFormat": "Total"
          }
        ],
        "options": {
          "colorMode": "value",
          "graphMode": "none"
        }
      },
      {
        "title": "Failed Collectors",
        "type": "stat",
        "gridPos": { "x": 6, "y": 0, "w": 6, "h": 4 },
        "targets": [
          {
            "expr": "sum(toolkit_collectors_failed)",
            "legendFormat": "Failed"
          }
        ],
        "options": {
          "colorMode": "value",
          "graphMode": "none"
        },
        "fieldConfig": {
          "defaults": {
            "thresholds": {
              "mode": "absolute",
              "steps": [
                { "value": 0, "color": "green" },
                { "value": 1, "color": "red" }
              ]
            }
          }
        }
      },
      {
        "title": "Avg Collection Duration",
        "type": "stat",
        "gridPos": { "x": 12, "y": 0, "w": 6, "h": 4 },
        "targets": [
          {
            "expr": "avg(toolkit_collection_duration_seconds)",
            "legendFormat": "Duration"
          }
        ],
        "options": {
          "colorMode": "value",
          "graphMode": "none"
        },
        "fieldConfig": {
          "defaults": {
            "unit": "s"
          }
        }
      },
      {
        "title": "Last Bundle Size",
        "type": "stat",
        "gridPos": { "x": 18, "y": 0, "w": 6, "h": 4 },
        "targets": [
          {
            "expr": "toolkit_bundle_size_bytes",
            "legendFormat": "{{service}}"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "bytes"
          }
        }
      },
      {
        "title": "Collection Duration by Service",
        "type": "timeseries",
        "gridPos": { "x": 0, "y": 4, "w": 12, "h": 8 },
        "targets": [
          {
            "expr": "toolkit_collection_duration_seconds",
            "legendFormat": "{{service}}"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "s"
          }
        }
      },
      {
        "title": "Bundle Size by Service",
        "type": "timeseries",
        "gridPos": { "x": 12, "y": 4, "w": 12, "h": 8 },
        "targets": [
          {
            "expr": "toolkit_bundle_size_bytes",
            "legendFormat": "{{service}}"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "bytes"
          }
        }
      },
      {
        "title": "Last Collection Time",
        "type": "table",
        "gridPos": { "x": 0, "y": 12, "w": 24, "h": 6 },
        "targets": [
          {
            "expr": "toolkit_last_collection_timestamp_seconds * 1000",
            "format": "table",
            "instant": true
          }
        ],
        "transformations": [
          {
            "id": "organize",
            "options": {
              "excludeByName": { "Time": true, "__name__": true },
              "renameByName": {
                "service": "Service",
                "Value": "Last Collection"
              }
            }
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "dateTimeAsIso"
          }
        }
      }
    ]
  }
}
